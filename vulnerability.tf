data "panos_vulnerability_security_profile" "example" {
    name = panos_vulnerability_security_profile.x.name
}

resource "panos_vulnerability_security_profile" "x" {
    name = "VB-RULE"
    device_group = "shared"
    description = "created by Terraform"
    rule {
        name = "High-Critical"
        category = "any"
        threat_name = "any"
        action = "reset-both"
        host = "any"
        severities = ["critical", "high"]
        cves = ["any"]
        vendor_ids = ["any"]
    }
    rule {
        name = "Medium"
        category = "any"
        threat_name = "any"
        action = "alert"
        host = "any"
        severities = ["medium"]
        cves = ["any"]
        vendor_ids = ["any"]
    }
    rule {
        name = "Informational-Low"
        category = "any"
        threat_name = "any"
        action = "alert"
        host = "any"
        severities = ["low", "informational"]
        cves = ["any"]
        vendor_ids = ["any"]
    }
 #   exception {
 #       name = data.panos_predefined_threat.siemens_overflow.threats.0.name
 #       action = "drop"
 #   }
}

#data "panos_predefined_threat" "siemens_overflow" {
#    threat_type = "vulnerability"
#    threat_name = "Siemens Tecnomatix FactoryLink SCADA CSService Buffer Overflow Vulnerability"
#}



